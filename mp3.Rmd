---
title: "Mini Project 3"
author: "Sophie Li, Rocio Jaime"
date: "November 15, 2017"
output: html_document
---

```{r}
library(mdsr)
library(RMySQL)
```

```{r}
db <- dbConnect_scidb(dbname = "imdb")
sequel_info <- db %>%
  dbGetQuery("SELECT ml.movie_id, t.title, ml.id, ml.linked_movie_id, t2.title AS sequel_title
FROM movie_link ml
JOIN title t ON t.id = ml.movie_id
JOIN title t2 ON t2.id = ml.linked_movie_id 
WHERE ml.link_type_id = 2
	AND t.kind_id = 1;
")

sequel_info %>% 
  group_by(title) %>% 
  filter(!(title %in% sequel_title)) %>% 
  summarize(num_sequels = n_distinct(sequel_title)) %>% 
  arrange(desc(num_sequels))

```